-- upgrading controlplane version
kubectl get nodes
sudo apt-mark unhold kubeadm && sudo apt-get update && sudo apt-get install -y kubeadm='1.31.1-*' && sudo apt-mark hold kubeadm
kubeadm version
sudo kubeadm upgrade plan
sudo kubeadm upgrade apply v1.31.1

-- Draining controlplane before performing update
kubectl drain controlplane --ignore-daemonsets
sudo apt-mark unhold kubelet kubectl && sudo apt-get update && sudo apt-get install -y kubelet='1.31.1-*' kubectl='1.31.1-*' && sudo apt-mark hold kubelet kubectl
sudo systemctl daemon-reload
sudo systemctl restart kubelet
kubectl uncordon controlplane

kubectl get nodes

-- to upgrade worker nodes (node01)
kubectl get nodes
ssh node01
sudo apt-mark unhold kubeadm && sudo apt-get update && sudo apt-get install -y kubeadm='1.31.1-*' && sudo apt-mark hold kubeadm
sudo kubeadm upgrade node
ssh controlplane
kubectl drain node01 --ignore-daemonsets
ssh node01
sudo apt-mark unhold kubelet kubectl && sudo apt-get update && sudo apt-get install -y kubelet='1.31.1-*' kubectl='1.31.1-*' && sudo apt-mark hold kubelet kubectl
sudo systemctl daemon-reload
sudo systemctl restart kubelet
ssh controlplane
kubectl uncordon node01
kubectl get nodes